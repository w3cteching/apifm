## api工厂的sdk的使用

   项目根目录下：npm  init -y
   安装：npm install apifm-wxapi
   在app.js中引入：
    
    const wxapi=require('apifm-wxapi')

    App({
        onLaunch: function () {
         WXAPI.init('hjl') 
        }
    }）

    这样初始化好后，就可以在其他页面用wxapi来调用接口了

    例如：摘取商品列表数据：

    wxapi.goods().then(res=>{

        console.log('wxapi.goods"',res)

    })

    建议：能用小程序wx.request调用接口的，咱们就不用api工厂wxapi调接口



## 小程序登录  

 1.微信授权

    通过wx.login()获取code值，只是一个临时凭证
    通过code利用wx.request调用小程序登录接口来换取token,代码如下：
```
   wx.login({
       success(res) {
         console.log('wx.login:',res)
         let {code}=res;
          wx.request({
            url: 'https://api.it120.cc/hjl/user/wxapp/login',
            data:{
              code
            },
            header:{
              'content-type':' application/x-www-form-urlencoded'
            },
            method:'POST',
            success(result) {
              console.log('登录返回',result)
            }
          })

       }
     })

```


  检测token是否有效接口：https://api.it120.cc/hjl/user/check-token

  微信检测session_key是否有效：

  获取用户信息：
  
     通过button的open-type="getUserInfo"  bindgetUserInfo="回调来获取用户信息的方法"
     通过wx.getUserInfo(success(res) {})


 2.存入你们公司后台数据库

     注册接口

     1.通过微信登录获取code的方式注册
        
        注册接口：/{domain}/user/wxapp/register/complex

        请求的参数：
            code	微信登录接口返回的 code 参数数据
            encryptedData	微信登录接口返回的 加密用户信息
            iv	微信登录接口返回的加密偏移数据	


     2.通过邮箱注册：通过用户管理接口测试
     3.通过手机号注册：通过用户管理接口测试



## 封装数据请求API接口

   API: application interface ,即编程接口
  
    1.提取公共的url

    2. 二次封装ajax请求(axios,$.ajax，wx.request)

    3. 基于业务封装的API:获取商品列表，添加购物车，添加收藏，搜索，商品说情

    4.通过Promise将请求的数据抛出，供用户使用

       new Promise(回调函数)

    5.对数据加载进行loading,toast处理


    封装好，如果在页面中调用？？？？


     getGoodsList().then(res=>{

      console.log('终于等到你',res)


    });

    

        


  